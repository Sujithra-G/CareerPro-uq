import { type NextRequest, NextResponse } from "next/server"

export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
    const { message, userId, language = "english", conversationHistory } = body

    // Simulate AI processing delay
    await new Promise((resolve) => setTimeout(resolve, 1500))

    // Mock AI responses based on message content and language
    let response = ""

    const lowerMessage = message.toLowerCase()

    if (language === "hindi") {
      if (lowerMessage.includes("career") || lowerMessage.includes("рдХрд░рд┐рдпрд░")) {
        response = `рдЖрдкрдХреА рд░реБрдЪрд┐рдпреЛрдВ рдФрд░ рдХреМрд╢рд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдореИрдВ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА, рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реЗрд╡рд╛, рдпрд╛ рд╡реНрдпрд╛рдкрд╛рд░ рдореЗрдВ рдХрд░рд┐рдпрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░реВрдВрдЧрд╛ред рдХреНрдпрд╛ рдЖрдкрдиреЗ рд╣рдорд╛рд░реА рдХрд░рд┐рдпрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдкреНрд░рд╢реНрдирд╛рд╡рд▓реА рд▓реА рд╣реИ? рдпрд╣ рдЖрдкрдХреА рдпреЛрдЧреНрдпрддрд╛ рдФрд░ рд░реБрдЪрд┐рдпреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИред\n\nрдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣реЗрдВрдЧреЗ рдХрд┐ рдореИрдВ рдЖрдкрдХреЛ рдХреБрдЫ рдХрд░рд┐рдпрд░ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдХрд░реВрдВ, рдпрд╛ рдЖрдк рдкрд╣рд▓реЗ рдкреНрд░рд╢реНрдирд╛рд╡рд▓реА рд▓реЗрдирд╛ рдкрд╕рдВрдж рдХрд░реЗрдВрдЧреЗ?`
      } else if (lowerMessage.includes("engineering") || lowerMessage.includes("рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ")) {
        response = `рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХрдИ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╢рд╛рдирджрд╛рд░ рдХреНрд╖реЗрддреНрд░ рд╣реИ! рдпрд╣рд╛рдВ рдХреБрдЫ рд▓реЛрдХрдкреНрд░рд┐рдп рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХрд░рд┐рдпрд░ рд╣реИрдВ:\n\nЁЯФз **рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ** - рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдбрд┐рдЬрд╝рд╛рдЗрди рдФрд░ рд╡рд┐рдХрд╕рд┐рдд рдХрд░реЗрдВ\nтЪб **рдЗрд▓реЗрдХреНрдЯреНрд░рд┐рдХрд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ** - рд╡рд┐рджреНрдпреБрдд рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдФрд░ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХреНрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдВ\nЁЯПЧя╕П **рд╕рд┐рд╡рд┐рд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ** - рдкреБрд▓реЛрдВ рдФрд░ рдЗрдорд╛рд░рддреЛрдВ рдЬреИрд╕реЗ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдХреЛ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд░реЗрдВ\nтЪЩя╕П **рдореИрдХреЗрдирд┐рдХрд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ** - рдорд╢реАрдиреЛрдВ рдФрд░ рдпрд╛рдВрддреНрд░рд┐рдХ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХреЛ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд░реЗрдВ\nЁЯзк **рдХреЗрдорд┐рдХрд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ** - рдФрджреНрдпреЛрдЧрд┐рдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рд░рд╕рд╛рдпрди рд╡рд┐рдЬреНрдЮрд╛рди рд▓рд╛рдЧреВ рдХрд░реЗрдВ\n\nрдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдЖрдкрдХреЛ рд╕рдмрд╕реЗ рдЬреНрдпрд╛рджрд╛ рджрд┐рд▓рдЪрд╕реНрдк рд▓рдЧрддреА рд╣реИ? рдореИрдВ рдЗрдирдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдХреНрд╖реЗрддреНрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВред`
      } else if (lowerMessage.includes("college") || lowerMessage.includes("рдХреЙрд▓реЗрдЬ")) {
        response = `рд╕рд╣реА рдХреЙрд▓реЗрдЬ рдЪреБрдирдирд╛ рдЖрдкрдХреА рдХрд░рд┐рдпрд░ рд╕рдлрд▓рддрд╛ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ! рдпрд╣рд╛рдВ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдореБрдЦреНрдп рдХрд╛рд░рдХ рд╣реИрдВ:\n\nЁЯУН **рд╕реНрдерд╛рди** - рдШрд░ рд╕реЗ рджреВрд░реА, рдЬрд▓рд╡рд╛рдпреБ, рд╢рд╣рд░реА рдмрдирд╛рдо рдЧреНрд░рд╛рдореАрдг\nЁЯОУ **рдХрд╛рд░реНрдпрдХреНрд░рдо** - рдЖрдкрдХреЗ рд╡рд╛рдВрдЫрд┐рдд рдкреНрд░рдореБрдЦ рдХреА рдЧреБрдгрд╡рддреНрддрд╛, рд╕рдВрдХрд╛рдп рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛\nЁЯТ░ **рд▓рд╛рдЧрдд** - рдЯреНрдпреВрд╢рди, рд░рд╣рдиреЗ рдХрд╛ рдЦрд░реНрдЪ, рд╡рд┐рддреНрддреАрдп рд╕рд╣рд╛рдпрддрд╛ рдЙрдкрд▓рдмреНрдзрддрд╛\nЁЯПл **рдХреИрдВрдкрд╕ рдЬреАрд╡рди** - рдЖрдХрд╛рд░, рд╕рдВрд╕реНрдХреГрддрд┐, рдкрд╛рдареНрдпреЗрддрд░ рдЧрддрд┐рд╡рд┐рдзрд┐рдпрд╛рдВ\nЁЯУИ **рдХрд░рд┐рдпрд░ рд╕реЗрд╡рд╛рдПрдВ** - рдиреМрдХрд░реА рдкреНрд▓реЗрд╕рдореЗрдВрдЯ рджрд░реЗрдВ, рдЗрдВрдЯрд░реНрдирд╢рд┐рдк рдЕрд╡рд╕рд░\n\nрдореИрдВ рдЖрдкрдХреА рд░реБрдЪрд┐рдпреЛрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЗ рдХреЙрд▓реЗрдЬреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рдЖрдкрдХреА рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВред рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣реЗрдВрдЧреЗ рдХрд┐ рдореИрдВ рдЖрдкрдХреЗ рд╕реНрдерд╛рди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреБрдЫ рд╡рд┐рдХрд▓реНрдк рджрд┐рдЦрд╛рдКрдВ?`
      } else {
        response = `рдпрд╣ рдПрдХ рдмреЗрд╣рддрд░реАрди рд╕рд╡рд╛рд▓ рд╣реИ! рдореИрдВ рдпрд╣рд╛рдВ рдХрд░рд┐рдпрд░ рдорд╛рд░реНрдЧрджрд░реНрд╢рди, рдХреЙрд▓реЗрдЬ рдХреА рдЬрд╛рдирдХрд╛рд░реА, рдкрд░реАрдХреНрд╖рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдФрд░ рдЫрд╛рддреНрд░рд╡реГрддреНрддрд┐ рдХреЗ рдЕрд╡рд╕рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЖрдкрдХреА рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реВрдВред\n\nрдпрд╣рд╛рдВ рдХреБрдЫ рддрд░реАрдХреЗ рд╣реИрдВ рдЬрд┐рдирд╕реЗ рдореИрдВ рдЖрдкрдХреА рд╕рд╣рд╛рдпрддрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ:\nтАв **рдХрд░рд┐рдпрд░ рд╕рд▓рд╛рд╣** - рдЙрдкрдпреБрдХреНрдд рдХрд░рд┐рдпрд░ рдкрде рдЦреЛрдЬрдиреЗ рдореЗрдВ рдЖрдкрдХреА рдорджрдж рдХрд░реЗрдВ\nтАв **рдХреЙрд▓реЗрдЬ рдХреА рдЬрд╛рдирдХрд╛рд░реА** - рдЖрдкрдХреЗ рд▓рд┐рдП рд╕рд╣реА рд╕рдВрд╕реНрдерд╛рди рдЦреЛрдЬреЗрдВ\nтАв **рд╕рдордпрд╕реАрдорд╛ рдкреНрд░рдмрдВрдзрди** - рдорд╣рддреНрд╡рдкреВрд░реНрдг рддрд╛рд░реАрдЦреЛрдВ рдХрд╛ рдЯреНрд░реИрдХ рд░рдЦреЗрдВ\nтАв **рдЫрд╛рддреНрд░рд╡реГрддреНрддрд┐ рдорд╛рд░реНрдЧрджрд░реНрд╢рди** - рдлрдВрдбрд┐рдВрдЧ рдХреЗ рдЕрд╡рд╕рд░ рдЦреЛрдЬреЗрдВ\n\nрдХреНрдпрд╛ рдЖрдк рдореБрдЭреЗ рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмрддрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдХреНрдпрд╛ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдореИрдВ рдЖрдкрдХреА рдХрд░рд┐рдпрд░ рдпрд╛рддреНрд░рд╛ рдХреЗ рд▓рд┐рдП рд╡реНрдпрдХреНрддрд┐рдЧрдд рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдВ рд╣реВрдВ!`
      }
    } else {
      // English responses (existing logic)
      if (lowerMessage.includes("career") && lowerMessage.includes("best")) {
        response = `Based on your interests and skills, I'd recommend exploring careers in technology, healthcare, or business. Have you taken our career assessment quiz yet? It can provide personalized recommendations based on your aptitude and interests.\n\nWould you like me to guide you through some career options, or would you prefer to take the quiz first?`
      } else if (lowerMessage.includes("engineering")) {
        response = `Engineering is a fantastic field with many specializations! Here are some popular engineering careers:\n\nЁЯФз **Software Engineering** - Design and develop applications and systems\nтЪб **Electrical Engineering** - Work with electrical systems and electronics  \nЁЯПЧя╕П **Civil Engineering** - Design infrastructure like bridges and buildings\nтЪЩя╕П **Mechanical Engineering** - Design machines and mechanical systems\nЁЯзк **Chemical Engineering** - Apply chemistry to industrial processes\n\nWhich type of engineering interests you most? I can provide more specific information about any of these fields.`
      } else if (lowerMessage.includes("college") || lowerMessage.includes("choose")) {
        response = `Choosing the right college is crucial for your career success! Here are key factors to consider:\n\nЁЯУН **Location** - Distance from home, climate, urban vs rural\nЁЯОУ **Programs** - Quality of your desired major, faculty expertise\nЁЯТ░ **Cost** - Tuition, living expenses, financial aid availability\nЁЯПл **Campus Life** - Size, culture, extracurricular activities\nЁЯУИ **Career Services** - Job placement rates, internship opportunities\n\nI can help you find colleges near you that match your interests. Would you like me to show you some options based on your location?`
      } else if (lowerMessage.includes("scholarship")) {
        response = `There are many scholarship opportunities available! Here are some types to explore:\n\nЁЯТб **Merit-based** - Based on academic achievement or test scores\nЁЯТ░ **Need-based** - Based on family financial situation  \nЁЯОп **Field-specific** - For particular majors like STEM or arts\nЁЯМН **Demographic** - For specific communities or backgrounds\nЁЯПЖ **Competition-based** - Essay contests, talent competitions\n\nI can help you find scholarships that match your profile. What field are you interested in studying? Also, check our timeline section for upcoming scholarship deadlines!`
      } else if (lowerMessage.includes("exam") || lowerMessage.includes("date")) {
        response = `Here are some important upcoming exam dates:\n\nЁЯУЪ **JEE Main 2024** - Registration ongoing until Dec 30\nЁЯй║ **NEET 2024** - Application deadline Dec 15  \nЁЯУЦ **CBSE Board Exams** - Registration starts Jan 5, 2025\nЁЯОУ **CAT 2024** - Results already declared\n\nFor the most up-to-date information and complete timeline, I recommend checking our Timeline section. Would you like me to show you more details about any specific exam?`
      } else if (lowerMessage.includes("planning") || lowerMessage.includes("help")) {
        response = `I'm here to help with your career planning! Here's how I can assist:\n\nтЬЕ **Career Assessment** - Take our quiz to discover your ideal career path\nЁЯОп **Personalized Recommendations** - Get AI-powered career suggestions\nЁЯПл **College Search** - Find institutions that match your goals\nЁЯУЕ **Timeline Management** - Track important deadlines and dates\nЁЯТм **Ongoing Support** - Ask me questions anytime!\n\nWhat specific area would you like to focus on first? I can guide you through any of these steps.`
      } else if (lowerMessage.includes("hi") || lowerMessage.includes("hello") || lowerMessage.includes("hey")) {
        response = `Hello! Great to meet you! I'm CareerPro, and I'm excited to help you navigate your career journey. \n\nI can assist you with:\nтАв Career recommendations based on your interests\nтАв College and university information  \nтАв Scholarship opportunities\nтАв Important exam dates and deadlines\nтАв General career planning advice\n\nWhat would you like to explore today? Feel free to ask me anything about your career path!`
      } else {
        response = `That's a great question! I'm here to help you with career guidance, college information, exam schedules, and scholarship opportunities.\n\nHere are some ways I can assist you:\nтАв **Career Advice** - Help you discover suitable career paths\nтАв **College Information** - Find the right institutions for you\nтАв **Timeline Management** - Keep track of important dates\nтАв **Scholarship Guidance** - Find funding opportunities\n\nCould you tell me more specifically what you'd like to know? I'm here to provide personalized guidance for your career journey!`
      }
    }

    console.log(`Chatbot response generated for user: ${userId} in ${language}`)

    return NextResponse.json({ response }, { status: 200 })
  } catch (error) {
    console.error("Error generating chat response:", error)
    return NextResponse.json(
      { response: "I'm sorry, I'm having trouble responding right now. Please try again in a moment." },
      { status: 500 },
    )
  }
}
